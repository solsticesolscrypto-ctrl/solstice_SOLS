const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.browser.esm-CWqLNxZS.js","assets/index-BMAFlnOM.js","assets/index-wOyaqGTV.css"])))=>i.map(i=>d[i]);
import{r as i,j as e,t as v,B as x,_ as z}from"./index-BMAFlnOM.js";const A=({setCurrentPage:C,language:S,showMessage:r})=>{const t=v[S]||v.es,[m,f]=i.useState({title:"",description:""}),[d,b]=i.useState(!1),[c,w]=i.useState(!1),[l,y]=i.useState(""),[p,g]=i.useState(!1),[P,o]=i.useState(""),k=async()=>{if(o(""),!window.solana||!window.solana.isPhantom){o(t["phantom-not-found"]);return}try{const a=await window.solana.connect({onlyIfTrusted:!1});w(!0),y(a.publicKey.toString())}catch{o(t["phantom-connect-error"])}},E=async()=>{if(window.solana&&window.solana.isPhantom)try{await window.solana.disconnect()}catch{}w(!1),y(""),g(!1)},T=async()=>{if(o(""),!c||!l){o("Conecta Phantom primero.");return}try{const{solana:a}=window;if(!a||!a.isPhantom)throw new Error("Phantom no est치 disponible");const s=await z(()=>import("./index.browser.esm-CWqLNxZS.js"),__vite__mapDeps([0,1,2])),n=new s.Connection("https://api.mainnet-beta.solana.com"),h=new s.PublicKey("3qxa32hbFKMTAesrtUBykqRcNnzGpix3F3QHQR5JcPBT"),N=new s.PublicKey(l),D=Math.floor(.001*1e9),u=new s.Transaction().add(s.SystemProgram.transfer({fromPubkey:N,toPubkey:h,lamports:D}));u.feePayer=N;const{blockhash:B}=await n.getLatestBlockhash();u.recentBlockhash=B;const F=await a.signTransaction(u),R=await n.sendRawTransaction(F.serialize());g(!0),o("")}catch(a){o("Error al pagar la comisi칩n: "+(a.message||""))}},j=a=>{const{name:s,value:n}=a.target;f(h=>({...h,[s]:n}))},_=async a=>{if(a.preventDefault(),!c||!l){o("Debes conectar Phantom para crear una propuesta.");return}if(!p){o("Debes pagar la comisi칩n de 0.001 SOL para crear una propuesta.");return}if(!m.title.trim()||!m.description.trim()){r&&r(t["proposal-form-title-desc-empty"]||t["proposal-form-page-subtitle"],"error");return}b(!0);try{await new Promise(s=>setTimeout(s,1500)),r&&r(t["proposal-creation-success"]||t["proposal-creation-success"],"success"),f({title:"",description:""}),setTimeout(()=>{C("dao")},1e3)}catch(s){console.error("Error al crear la propuesta:",s);const n=t["proposal-creation-error"]||"Error creating proposal:";r&&r(`${n} ${s.message}`,"error")}finally{b(!1)}};return e.jsxs("section",{className:"space-y-8",children:[e.jsxs("div",{className:"text-center narrow",children:[e.jsx("div",{className:"section-header"}),e.jsx("h1",{className:"fluid-h2 font-bold gradient-text mb-4",children:t["proposal-form-page-title"]}),e.jsx("p",{className:"fluid-subtitle text-gray-400 max-w-2xl mx-auto mb-8",children:t["proposal-form-page-subtitle"]})]}),e.jsx("div",{className:"narrow section",children:e.jsxs("div",{className:"card p-6 md:p-8 flex flex-col gap-4 items-center",children:[c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs text-[#66fcf1] font-mono mb-2",children:[t["phantom-connected"],": ",l.slice(0,7),"...",l.slice(-7)]}),e.jsx("button",{onClick:E,className:"mt-1 px-3 py-1 text-xs rounded bg-red-600 text-white hover:bg-red-700 transition font-bold shadow",children:t.disconnect||"Desconectar"})]}):e.jsx(x,{onClick:k,size:"lg",className:"w-fit",children:t.connect_phantom||"Conectar Phantom"}),c&&!p&&e.jsx(x,{onClick:T,size:"md",className:"w-fit bg-yellow-400 text-[#0b0c10] hover:bg-yellow-500 mt-2",children:t["pay-commission"]||"Pagar comisi칩n 0.001 SOL"}),P&&e.jsx("div",{className:"bg-red-700/80 text-white text-sm text-center mt-2 px-4 py-2 rounded-xl shadow border border-red-400 animate-pulse w-fit mx-auto",children:P}),e.jsxs("form",{onSubmit:_,className:"space-y-6 w-full",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-left text-white font-bold mb-2",children:t["proposal-form-title-label"]}),e.jsx("input",{type:"text",id:"title",name:"title",value:m.title,onChange:j,required:!0,className:"input",placeholder:t["proposal-form-title-placeholder"]||t["proposal-form-title-label"],disabled:d})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-left text-white font-bold mb-2",children:t["proposal-form-desc-label"]}),e.jsx("textarea",{id:"description",name:"description",value:m.description,onChange:j,rows:"6",required:!0,className:"textarea",placeholder:t["proposal-form-desc-placeholder"]||t["proposal-form-desc-label"],disabled:d})]}),e.jsx(x,{type:"submit",size:"lg",className:"w-full",loading:d,disabled:!c||!p,children:t["proposal-form-btn-submit"]})]})]})})]})};export{A as default};
