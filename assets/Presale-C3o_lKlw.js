import{r as o,j as e,B as E}from"./index-D7vVvMPx.js";import{Connection as W,PublicKey as M,Transaction as q,SystemProgram as z}from"./index.browser.esm-Co22Wmx2.js";async function H(t=5){const n="3qxa32hbFKMTAesrtUBykqRcNnzGpix3F3QHQR5JcPBT",u="https://mainnet.helius-rpc.com/?api-key=b4aa694f-00a7-49e2-8e19-83e793d508c1",i=await(await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:"recent-txs",method:"getSignaturesForAddress",params:[n,{limit:t}]})})).json();return i.result?(await Promise.all(i.result.map(async x=>{const y={jsonrpc:"2.0",id:"tx-details",method:"getTransaction",params:[x.signature,{encoding:"jsonParsed"}]},N=(await(await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).json()).result?.transaction?.message?.instructions||[];let d="",m=0;for(const a of N)a.parsed&&a.parsed.type==="transfer"&&a.parsed.info?.destination===n&&(d=a.parsed.info.source,m=Number(a.parsed.info.lamports)/1e9);if(!d||m===0)return null;const h=m*1e4;return{wallet:d.slice(0,4)+"..."+d.slice(-3),fullWallet:d,tokens:Math.round(h),sol:m}}))).filter(Boolean):[]}const J="3qxa32hbFKMTAesrtUBykqRcNnzGpix3F3QHQR5JcPBT",X=({t})=>{const[n,O]=o.useState("");t["solana-network-label"]||t["network-label"];const u=4e6,[g,k]=o.useState(""),[i,l]=o.useState(""),[x,y]=o.useState(!1),[P,C]=o.useState([]),[N,d]=o.useState(!0),m=1e6,[h,R]=o.useState(0),a=Math.min(100,Math.round(h/m*100));function A(s){return s<20?.5:s<50?.25:s<80?.1:.01}const v=A(a),_=h*.01,[j,f]=o.useState(!1),[w,p]=o.useState(""),[K,L]=o.useState(!1);o.useEffect(()=>{function s(c){f(!0),p(window.solana.publicKey?.toString()||"")}function r(){f(!1),p("")}return window.solana&&window.solana.isPhantom&&(f(window.solana.isConnected),p(window.solana.publicKey?.toString()||""),window.solana.on("connect",s),window.solana.on("disconnect",r)),()=>{window.solana&&window.solana.isPhantom&&(window.solana.off("connect",s),window.solana.off("disconnect",r))}},[]),o.useEffect(()=>{let s=!0;return d(!0),H(100).then(r=>{if(s){C(r);const c=r.filter(b=>Number(b.sol)!==.001).reduce((b,S)=>b+(S.tokens||0),0);R(c),d(!1)}}),()=>{s=!1}},[]);const $=async()=>{if(l(""),L(!0),!window.solana||!window.solana.isPhantom){window.open("https://phantom.app/download","_blank"),l("phantom-not-found"),L(!1);return}try{const s=await window.solana.connect();f(!0),p(s.publicKey?.toString()||window.solana.publicKey?.toString()||"")}catch{l("phantom-connect-error")}L(!1)},B=async()=>{try{window.solana&&window.solana.isPhantom&&await window.solana.disconnect(),f(!1),p("")}catch{}},D=async s=>{if(s.preventDefault(),k(""),l(""),!window.solana||!window.solana.isPhantom){l("phantom-not-found");return}let r=w;if(!j||!w||window.solana.publicKey?.toString()!==w)try{r=(await window.solana.connect()).publicKey?.toString()||window.solana.publicKey?.toString()||"",f(!0),p(r)}catch{l("presale-connect-required");return}if(!n||isNaN(n)||Number(n)<v){l("min-solana-rent");return}if(Number(n)*1e4>u){l("presale-max-tokens-wallet");return}y(!0);try{const c=new W("https://mainnet.helius-rpc.com/?api-key=b4aa694f-00a7-49e2-8e19-83e793d508c1"),b=new M(J),S=new M(r),I=Math.floor(Number(n)*1e9),T=new q().add(z.transfer({fromPubkey:S,toPubkey:b,lamports:I}));T.feePayer=S;const{blockhash:F}=await c.getLatestBlockhash();T.recentBlockhash=F;const U=await window.solana.signTransaction(T),G=await c.sendRawTransaction(U.serialize());k("presale-success")}catch(c){console.error("Error en la transacción Phantom:",c),l("presale-tx-error")}y(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full flex flex-row items-center justify-between mb-8",children:[e.jsx("div",{className:"text-xs text-[#66fcf1] font-semibold text-center",children:"Red: Solana"}),e.jsx("div",{className:"max-w-[340px]",children:j?e.jsxs("div",{className:"flex flex-row items-center gap-2 bg-[#181a20]/70 rounded-lg px-2 py-1 border border-[#23242a]",children:[e.jsx(E,{onClick:B,className:"px-3 py-1 text-xs rounded-lg font-bold bg-gradient-to-r from-pink-500 to-yellow-400 text-[#181a20] border-2 border-pink-400 shadow hover:from-yellow-400 hover:to-pink-500 transition-all duration-200",children:t.disconnect||"Desconectar"}),e.jsx("span",{className:"text-xs text-[#66fcf1] font-mono truncate max-w-[120px]",children:w})]}):e.jsx("div",{children:e.jsx(E,{onClick:$,className:"px-4 py-1 text-sm rounded-lg font-bold bg-gradient-to-r from-[#66fcf1] to-[#45a29e] text-[#181a20] border-2 border-[#66fcf1] shadow-md hover:from-[#45a29e] hover:to-[#66fcf1] transition-all duration-200",disabled:x||K,children:K?"Conectando...":t["presale-connect-phantom"]||t["dao-btn-connect-wallet"]||t["connect-phantom"]||"Conectar Wallet"})})})]}),e.jsxs("header",{className:"text-center mx-auto w-fit mb-8",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold gradient-text drop-shadow mb-3",children:t["presale-page-title"]||"Oficial $SOLS Preventa"}),e.jsx("p",{className:"text-lg md:text-xl text-gray-300 mb-6 w-fit mx-auto",children:t["presale-page-subtitle"]||"Asegura tu participación en el futuro del ecosistema Solstice. ¡El tiempo es limitado!"})]}),e.jsxs("div",{className:"flex flex-col items-center w-full gap-1 rounded-xl",children:[e.jsxs("div",{className:"w-full max-w-[340px] bg-[#181a20]/80 rounded-2xl border border-[#23242a] shadow-lg p-4 flex flex-col gap-2 mb-2",children:[e.jsx("div",{className:"flex flex-row justify-between items-center mb-1",children:e.jsx("span",{className:"text-base text-[#66fcf1] font-bold",children:t["presale-launch-label"]||"Solstice Presale 200,000,000 SOLS"})}),e.jsxs("div",{className:"flex flex-row justify-between items-center text-xs font-semibold",children:[e.jsxs("span",{className:"text-gray-200",children:[h.toLocaleString()," SOL Raised"]}),e.jsxs("span",{className:"text-[#66fcf1]",children:["$",_.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex flex-row justify-between items-center text-xs font-mono",children:[e.jsx("span",{className:"text-gray-300",children:t["presale-goal"]||"20,000 SOL Goal"}),e.jsxs("span",{className:"text-[#66fcf1] font-bold",children:[a,"%"]})]}),e.jsx("div",{className:"w-full flex flex-row items-center gap-2 mt-1",children:e.jsx("div",{className:"flex-1 h-5 bg-[#23242a] rounded-full overflow-hidden relative border border-[#393b41]",children:e.jsx("div",{className:"h-full bg-[#66fcf1] transition-all duration-700 ease-in-out shadow-lg",style:{width:a===0?"2%":`${a}%`,boxShadow:"0 0 8px 2px #66fcf1",borderRadius:"9999px",border:"2px solid #66fcf1",background:"linear-gradient(90deg, #66fcf1 60%, #45a29e 100%)"}})})})]}),e.jsxs("span",{className:"text-xs font-semibold px-4 py-1 tracking-wide relative inline-block",style:{color:"#66fcf1",background:"transparent",boxShadow:"none",borderRadius:"0",marginTop:"1.5rem",marginBottom:"1.5rem",display:"block"},children:[e.jsx("span",{style:{content:'""',position:"absolute",left:"-18px",right:"-18px",top:0,height:"2px",background:"#66fcf1",borderRadius:"2px",zIndex:1},className:"block","aria-hidden":"true"}),t["presale-price-label"]||"Precio del Token: 0.0001 SOLS",e.jsx("span",{style:{content:'""',position:"absolute",left:"-18px",right:"-18px",bottom:0,height:"2px",background:"#66fcf1",borderRadius:"2px",zIndex:1},className:"block","aria-hidden":"true"})]}),e.jsxs("div",{className:"w-full max-w-xs sm:max-w-sm md:max-w-md mx-auto flex flex-col items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-xs text-gray-400 block text-center",children:t["presale-max-tokens-wallet"]||"Máximo = 4,000,000 tokens solstice por cartera"}),e.jsxs("span",{className:"text-xs text-yellow-400 block text-center",children:[a<20&&`${t["presale-min-label-prefix"]||"Mínimo de compra:"} 0.5 SOL`,a>=20&&a<50&&`${t["presale-min-label-prefix"]||"Mínimo de compra:"} 0.25 SOL`,a>=50&&a<80&&`${t["presale-min-label-prefix"]||"Mínimo de compra:"} 0.1 SOL`,a>=80&&`${t["presale-min-label-prefix"]||"Mínimo de compra:"} 0.01 SOL`]})]})]}),e.jsxs("form",{onSubmit:D,className:"flex flex-col gap-6 w-full max-w-xs sm:max-w-sm md:max-w-md mx-auto items-center",children:[e.jsx("div",{className:"flex flex-col w-full items-center gap-4",children:e.jsxs("div",{className:"flex flex-row w-full items-center gap-2 justify-center",children:[e.jsx("input",{type:"number",min:v,max:u/1e4,step:"0.01",placeholder:t["presale-amount-placeholder"]||t["amount-placeholder"]||"Cantidad a comprar",className:"p-3 bg-[#181a20] text-white rounded-xl border border-[#23242a] focus:outline-none focus:ring-2 focus:ring-[#66fcf1] w-[160px] text-center placeholder:text-white/40 placeholder:font-light shadow-sm",style:{color:"#fff"},value:n,onChange:s=>O(s.target.value),disabled:x||!j,autoComplete:"off"}),e.jsx(E,{type:"submit",className:"px-6 py-3 text-base font-bold text-center text-black bg-[#66fcf1] rounded-2xl shadow-md hover:bg-[#45a29e] transition-all select-none",style:{background:"none",boxShadow:"none",padding:0,margin:0,color:"#0b0c10",backgroundColor:"#66fcf1"},disabled:x||!j||!w,children:x?t["presale-buy-loading"]||"Procesando...":t["presale-buy"]||"Comprar"})]})}),n&&!isNaN(n)&&Number(n)>0&&e.jsx("div",{className:"w-full text-center mt-2 mb-2",children:e.jsxs("span",{className:"text-sm text-[#66fcf1] font-semibold",children:["Vas a recibir: ",e.jsxs("span",{className:"font-bold",children:[Number(n)*1e4," $SOLS"]})," en tu wallet Phantom"]})})]}),i&&e.jsx("span",{style:{color:"#e74c3c",display:"block",textAlign:"center",marginTop:8},children:i==="presale-max-tokens-wallet"?t["presale-max-tokens-wallet"]||"Máximo = 4,000,000 tokens solstice por cartera":i==="min-solana-rent"?`El monto mínimo permitido actualmente es ${v} SOL.`:t[i]||t["presale-tx-error"]||i}),g&&e.jsx("div",{className:"bg-green-700/90 text-white text-sm text-center mt-2 py-2 rounded-2xl shadow border border-green-400 animate-fade-in w-fit mx-auto",children:t[g]||g}),e.jsxs("div",{className:"w-full max-w-md mx-auto mt-14",children:[e.jsx("h3",{className:"text-lg font-bold text-[#66fcf1] mb-3 text-center",children:t["presale-recent-purchases-title"]||"Compras recientes"}),e.jsxs("ul",{className:"bg-[#181a20]/80 rounded-xl shadow border border-[#23242a] divide-y divide-[#23242a] min-h-[60px]",children:[e.jsxs("li",{className:"flex items-center justify-between px-4 py-2 text-xs text-[#66fcf1] font-bold bg-[#23242a]/60 border-b border-[#23242a]",children:[e.jsx("span",{className:"w-1/3",children:"Wallet"}),e.jsx("span",{className:"w-1/3 text-center",children:"Tokens"}),e.jsx("span",{className:"w-1/3 text-right",children:"SOL"})]}),N&&e.jsx("li",{className:"px-4 py-3 text-center text-gray-400",children:t["presale-loading-txs"]||"Cargando transacciones..."}),!N&&P.length===0&&e.jsx("li",{className:"px-4 py-3 text-center text-gray-400",children:t["presale-no-recent-purchases"]||"No hay compras recientes."}),P.map((s,r)=>e.jsxs("li",{className:"flex items-center justify-between px-4 py-3",children:[e.jsx("span",{className:"w-1/3 truncate",children:e.jsx("a",{href:`https://solscan.io/account/${s.fullWallet||""}`,target:"_blank",rel:"noopener noreferrer",className:"font-mono text-[#66fcf1] underline text-xs hover:text-[#45a29e] transition-colors",title:s.fullWallet||s.wallet,children:s.wallet})}),e.jsx("span",{className:"w-1/3 text-center",children:Number(s.sol)===.001?e.jsx("span",{className:"font-bold text-yellow-400",children:t["dao-commission-label"]}):e.jsxs("span",{className:"font-bold text-[#66fcf1]",children:[s.tokens.toLocaleString()," $SOLS"]})}),e.jsx("span",{className:"w-1/3 text-right",children:e.jsxs("span",{className:"text-xs text-gray-400",children:[s.sol," SOL"]})})]},r))]})]})]})};export{X as default};
